<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.1">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="RL, Libération">
<meta name="dcterms.date" content="2020-03-28">
<meta name="description" content="A scathing article on Didier Raoult published at a time when the media and politicians were still showering him with praise.">

<title>Didier Raoult Accused of Scientific Fraud: What Should We Believe? – RL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CFSZ45W5CV"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
 
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
gtag('config', 'G-CFSZ45W5CV', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(dore_virus.jpg);
background-size: cover;
      }
</style>
<style>
.quarto-title-block .quarto-title-banner {
  background-position-y: center;
  height: 400px;
}
</style>


<meta property="og:title" content="Didier Raoult Accused of Scientific Fraud: What Should We Believe? – RL">
<meta property="og:description" content="A scathing article on Didier Raoult published at a time when the media and politicians were still showering him with praise.">
<meta property="og:image" content="https://romainligneul.github.io/blog_en/posts/raoultfraud/dore_virus.jpg">
<meta property="og:site_name" content="Romain Ligneul">
<meta property="og:locale" content="en_US">
<meta name="twitter:title" content="Didier Raoult Accused of Scientific Fraud: What Should We Believe? – RL">
<meta name="twitter:description" content="A scathing article on Didier Raoult published at a time when the media and politicians were still showering him with praise.">
<meta name="twitter:image" content="https://romainligneul.github.io/blog_en/posts/raoultfraud/dore_virus.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">RL</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog_en/"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../codes.html"> 
<span class="menu-text">Code</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../.././"> 
<span class="menu-text"><iconify-icon inline="" icon="emojione:flag-for-us-outlying-islands" aria-label="Icon flag-for-us-outlying-islands from emojione Iconify.design set." title="Icon flag-for-us-outlying-islands from emojione Iconify.design set."></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../.././fr"> 
<span class="menu-text"><iconify-icon inline="" icon="emojione:flag-for-france" aria-label="Icon flag-for-france from emojione Iconify.design set." title="Icon flag-for-france from emojione Iconify.design set."></iconify-icon></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/romainligneul" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-twitter"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/causalself">
            (EN, research)
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/nerfsocial">
            (FR, society)
            </a>
          </li>
      </ul>
    </div>
    <a href="https://www.linkedin.com/in/romain-ligneul-b63b46192/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
    <a href="https://www.adaptivecontrol.org" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-lightbulb"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Didier Raoult Accused of Scientific Fraud: What Should We Believe?</h1>
                  <div>
        <div class="description">
          A scathing article on Didier Raoult published at a time when the media and politicians were still showering him with praise.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">liberation</div>
                <div class="quarto-category">covid19</div>
                <div class="quarto-category">research</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>RL, Libération </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 28, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#personal-attacks-fraud-accusations-and-methodological-criticisms" id="toc-personal-attacks-fraud-accusations-and-methodological-criticisms" class="nav-link active" data-scroll-target="#personal-attacks-fraud-accusations-and-methodological-criticisms">Personal Attacks, Fraud Accusations, and Methodological Criticisms</a></li>
  <li><a href="#triple-hats-and-flawed-statistics" id="toc-triple-hats-and-flawed-statistics" class="nav-link" data-scroll-target="#triple-hats-and-flawed-statistics">Triple Hats and Flawed Statistics</a></li>
  <li><a href="#a-deplorable-media-strategy" id="toc-a-deplorable-media-strategy" class="nav-link" data-scroll-target="#a-deplorable-media-strategy">A Deplorable Media Strategy</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further Reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Since the beginning of the Covid-19 crisis, Professor Didier Raoult has established himself as an essential figure in the public debate through forceful statements and extensive interviews.</p>
<p>Unsurprisingly, the publication of the results of his study evaluating the effectiveness of a treatment combining chloroquine and azithromycin received significant media attention. Given Professor Raoult’s controversial reputation and the sensitive nature of the study, it is not surprising that the scientific community also scrutinized the results with a particularly critical eye.</p>
<p>Approved on March 6, submitted on March 16, and published on March 20, this study is currently the subject of accusations of negligence or even scientific fraud by several researchers and science journalists. Among them, the tenacious Leonid Schneider — who was already at the origin of <a href="https://web.archive.org/web/20201205015421/https://fr.wikipedia.org/wiki/Catherine_Jessus#Affaire_de_m%C3%A9conduite_scientifique">the Catherine Jessus case in 2017</a> — published a particularly harsh blog post against Professor Raoult. As in the Jessus case, this new <a href="https://web.archive.org/web/20201205015421/https://forbetterscience.com/2020/03/26/chloroquine-genius-didier-raoult-to-save-the-world-from-covid-19/?fbclid=IwAR0KXLuANcVozIE_P6EpSY5O0p0DgkN4pTXtGm6htfhqt1L5l5Joe76xKsw">post</a> mixes proven facts, ad hominem attacks, and “evidence” of scientific fraud.</p>
<p>In the face of what can only be called a torrent of mud, what should we believe?</p>
<section id="personal-attacks-fraud-accusations-and-methodological-criticisms" class="level3">
<h3 class="anchored" data-anchor-id="personal-attacks-fraud-accusations-and-methodological-criticisms">Personal Attacks, Fraud Accusations, and Methodological Criticisms</h3>
<p>As is often the case in such situations, there are objective facts, hypotheses to verify, and contextual elements that contribute to painting an unnecessarily dark picture.</p>
<p>I will not dwell on the second part of Schneider’s post, which accuses Professor Didier Raoult of being a torturer who does not hesitate to publicly humiliate his students, a misogynist who tried to cover up a sexual harassment case within his institute, and an early climate change skeptic. Given his <a href="https://web.archive.org/web/20201205015421/https://www.francetvinfo.fr/sante/maladie/coronavirus/coronavirus-qui-est-didier-raoult-la-star-mondiale-de-la-microbiologie-qui-assure-avoir-trouve-le-remede-contre-le-covid-19_3884387.html">overinflated ego</a> and his tendency to denigrate his peers, it is not surprising that Professor Raoult has made many enemies, and it is not for me to judge the veracity of the facts presented, as concerning as they appear. But if we want to portray the man behind the researcher, we must not forget that we are still talking about a doctor who has dedicated his life to treating patients and advancing infectiology.</p>
<p>Among the hypotheses to be verified are several serious accusations of scientific fraud related to recent publications co-signed by Professor Raoult. However, image manipulations and sequencing errors will need to be thoroughly investigated before being considered as proof of fraud. Additionally, Professor Raoult is only an intermediate author on most of these studies: given the enormous number of articles he publishes each year, it is highly unlikely that these errors — if proven — are the result of direct intervention on his part.</p>
<p>In my opinion, this accumulation of accusations looks more like a witch hunt than scientific criticism, and it obscures the essential question: should we place our hopes in the treatment proposed by Professor Didier Raoult? Here, it is no longer the statements and insinuations of Leonid Schneider that need to be examined, but the facts highlighted by other active researchers.</p>
</section>
<section id="triple-hats-and-flawed-statistics" class="level3">
<h3 class="anchored" data-anchor-id="triple-hats-and-flawed-statistics">Triple Hats and Flawed Statistics</h3>
<p>Before diving into the heart of the matter, it is worth noting with some discomfort that the editor-in-chief of the <a href="https://web.archive.org/web/20201205015421/https://www.journals.elsevier.com/international-journal-of-antimicrobial-agents">journal</a> where the article was published is none other than Jean-Marc Rolain, who is also a co-author and subordinate of Professor Raoult at the IHU Méditerranée. Such triple roles are generally frowned upon in the academic world because it becomes difficult to believe in an impartial and unbiased evaluation of the scientific quality of the work reported.</p>
<p>Most of the criticisms have been posted on the site <a href="https://web.archive.org/web/20201205015421/https://pubpeer.com/publications/B4044A446F35DF81789F6F20F8E0EE">Pubpeer</a> (a platform for post-publication peer review) or on <a href="https://web.archive.org/web/20201205015421/https://www.medrxiv.org/content/10.1101/2020.03.16.20037135v1">MedRxiv</a> (a preprint server for health sciences). However, one should first look at the very concise report posted by three British researchers on the site <a href="https://web.archive.org/web/20201205015421/https://zenodo.org/record/3724167#.Xn92T4j7SUm">Zenodo</a>. Proof of the attention it garnered, this report was downloaded over 18,000 times in five days.</p>
<p>The report’s authors first indicate that the paper underwent virtually no modifications between its posting on MedRxiv and its “official” publication in Jean-Marc Rolain’s journal. This means that the reviewers responsible for identifying any methodological issues found none, or their criticisms were ignored.</p>
<p>However, the criticisms are numerous and often legitimate:</p>
<p>• The statistical analyses reported in the paper are flawed because age and symptom differences between the tested groups were not accounted for. That said, a <a href="https://web.archive.org/web/20201205015421/https://nfaivre.netlify.com/files/master.html">reanalyis of the data</a> shows that the main effects hold when these variables are considered.</p>
<p>• The possible (and likely) existence of biases in how patient groups were constituted. Thus, the control group patients (i.e., without treatment) were not all treated by Professor Raoult’s institute, unlike the patients receiving chloroquine. However, since the control group patients were on average younger and less often male, this lack of randomization probably does not invalidate the study’s conclusions on its own.</p>
<p>• More problematic is that Professor Raoult’s team excluded six patients from the treatment group post hoc. Among them, one death, three patients admitted to intensive care, one patient with nausea, and one patient who “left the hospital.” This is serious because at least four of these patients can be considered therapeutic failures. Excluding them could have significantly skewed the statistical conclusions given the small sample sizes tested.</p>
<p>• Finally, and most importantly, the report’s authors and many other scientists point to the absence of proper clinical data on patient outcomes. The only variable considered is viral load, so it is exaggerated and even dishonest to loudly proclaim, based on this study alone, that the combination of chloroquine and azithromycin constitutes a treatment for the disease. To date, the only <a href="https://web.archive.org/web/20201205015421/http://www.zjujournals.com/med/EN/10.3785/j.issn.1008-9292.2020.03.03#1">other publication</a> evaluating chloroquine’s effectiveness suggests that it has no effect, taken alone, on clinical outcomes. It is therefore possible that Professor Raoult’s treatment makes the virus undetectable in the upper airways (where the samples are taken) without eradicating it from the rest of the body (notably the lungs).</p>
</section>
<section id="a-deplorable-media-strategy" class="level3">
<h3 class="anchored" data-anchor-id="a-deplorable-media-strategy">A Deplorable Media Strategy</h3>
<p>These criticisms suggest that Professor Raoult and his team’s recommendations are very premature, and certain irregularities highlighted — both in the British researchers’ report and on Pubpeer — suggest that the analyses fall far short of the standards expected given the severity of the crisis and the therapeutic directions that might be taken in response to the infectious disease specialist’s media campaign.</p>
<p>Of course, the health emergency justifies the rapid publication of the most promising scientific results. That is not the question. Nor is it a question of who Professor Raoult really is. What matters now is that the public debate can take place in good conditions without anyone using the crisis to put themselves in the spotlight.</p>
<p>There is thus reason to be annoyed by Professor Raoult’s explosive and immodest positions, as he is quick to self-congratulate and disqualify the work of his peers.</p>
<p>And there is reason to lament, conversely, the little attention received by the Academy of Medicine, which considers that “the public release of hydroxychloroquine for hospitalized patients in respiratory distress is not an appropriate response for patients whose viral load is, at this stage, mostly nonexistent and whose illness is no longer a strictly viral disease but a pulmonary failure” (official statement, <a href="https://web.archive.org/web/20201205015421/http://www.academie-medecine.fr/wp-content/uploads/2020/03/20.3.26-Communiqu%C3%A9-Anm-AnP-Chloroquine.pdf?fbclid=IwAR0JDrgql1A2se6XKhzcatX6a6HS8KfSVOoXetI_e0mnU3F46P4vA-HnMaM">here</a>).</p>
</section>
<section id="further-reading" class="level3">
<h3 class="anchored" data-anchor-id="further-reading">Further Reading</h3>
<p><a href="https://web.archive.org/web/20201205015421/https://www.heidi.news/articles/coronavirus-didier-raoult-enfonce-le-clou-avec-une-deuxieme-publication-sur-la-chloroquine?fbclid=IwAR12JA0ZUX6fU-x38-uNfPDxAKHxwOE_wfOa-afqmiH7CNROSUBml7-u_zg">Analysis</a> of the latest paper published on Saturday, March 28, by Professor Raoult’s team, still inconclusive despite the inclusion of a larger number of patients.</p>
<p>Illustration, <a href="https://web.archive.org/web/20201205015421/https://www.instagram.com/antoinedoreart/?hl=fr">Antoine Doré</a></p>
<p><a href="https://web.archive.org/web/20201205015421/http://hemisphere-gauche.blogs.liberation.fr/2020/03/28/didier-raoult-accuse-de-fraude-scientifique-que-faut-il-croire/"><strong>Original Article (Wayback Machine)</strong></a></p>
<script src="https://giscus.app/client.js" data-repo="romainligneul/giscus-comments" data-repo-id="R_kgDOMSMTIw" data-category="CommentsBlogFR" data-category-id="DIC_kwDOMSMTI84CglZk" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async=""> </script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/romainligneul\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Romain Ligneul</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>