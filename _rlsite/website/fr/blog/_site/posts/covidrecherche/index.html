<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.1">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="RL, L’insoumission">
<meta name="dcterms.date" content="2021-01-20">
<meta name="description" content="Un article rédigé pour les groupes thématiques Santé et ESR de la France insoumise.">

<title>Covid-19 et recherche publique: le fossé s’élargit entre les besoins et les moyens – blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(images/coronavirus.jpg);
background-size: cover;
      }
</style>
<style>
.quarto-title-block .quarto-title-banner {
  background-position-y: center;
  height: 400px;
}
</style>


<link rel="stylesheet" href="../../../custom.scss">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Covid-19 et recherche publique: le fossé s’élargit entre les besoins et les moyens</h1>
                  <div>
        <div class="description">
          Un article rédigé pour les groupes thématiques Santé et ESR de la France insoumise.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">linsoumission</div>
                <div class="quarto-category">covid19</div>
                <div class="quarto-category">recherche</div>
                <div class="quarto-category">politique</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>RL, L’insoumission </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 20, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Alors que la pandémie continue de battre son plein, il apparaît de plus en plus clairement que notre profonde dépendance vis à vis des acteurs privés est la source d’incertitudes qui menacent les intérêts nationaux. La campagne vaccinale en cours montre comment le sous-financement de la recherche publique et le manque de considération que lui porte notre gouvernement limitent notre capacité à orienter les politiques sanitaires de façon rationnelle.&nbsp;</p>
<p><strong>Pourquoi l’évaluation indépendante des vaccins est-elle indispensable?</strong></p>
<p>L’absence de stratégie publique permettant l’évaluation rigoureuse et indépendante des différents vaccins nous rend notamment tributaires des entreprises pharmaceutiques capables de faire valider leur essais cliniques auprès des agences française et européennes (EMA, ANSM), qui sont la cible d’un lobbying intense de la part de l’EPFIA<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, la fédération européenne des industries pharmaceutiques.</p>
<p>Il est difficile dans ces conditions d’évaluer sereinement l’efficacité et la sécurité des vaccins, comme le contenus des documents volés à l’Agence Européenne des Médicaments le montre<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Il apparaît que l’agence aurait subi des pressions politiques de la part de certains états membres et de la Commission Européenne<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Par ailleurs, les vaccins commercialisés auraient une concentration en ARNm moindre que ceux utilisés lors des essais cliniques malgré l’intervention de l’EMA. Si les répercussions de cette dernière affaire sur la campagne vaccinale restent difficiles à évaluer, il est clair que l’industrie pharmaceutique apparaît une nouvelle fois comme peu consciencieuse, ce qui risque d’aggraver la défiance des français à son égard. Rappelons qu’à ce jour, seulement 1 français sur 2 est prêt à se faire vacciner<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.&nbsp;</p>
<p><strong>Le financement de la recherche publique sur Covid-19 reste largement insuffisant !</strong></p>
<p>Face à ce constat, il apparaît urgent d’investir dans la recherche publique de manière à permettre une évaluation indépendante des différentes options, aussi bien en matière de sécurité que d’efficacité. Or, malgré les effets d’annonce, les efforts concrets du gouvernement sont très limités en la matière.&nbsp;</p>
<p>Une plateforme dédiée aux essais cliniques, Covireivac<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, a été créée en juillet dernier, mais celle-ci héberge principalement des essais “à promotion industrielle” qui sont donc à la charge des groupes pharmaceutiques désireux de travailler sur une cohorte française. Le seul essai&nbsp; “à promotion académique” porte sur l’effet du vaccin Moderna chez les personnes âgées mais il est de très petite taille (180 volontaires), ce qui donne une idée du faible effort financier consenti par le gouvernement. Si les crédits étaient débloqués, Covireivac pourrait parfaitement évaluer plus de vaccins (y compris les vaccins chinois ou russes) sur des cohortes bien plus larges puisque des dizaines de milliers de citoyens se sont déjà déclarés volontaires sur la plateforme.&nbsp;</p>
<p><strong>Derrière les effets d’annonce, une fragilisation des structures existantes</strong></p>
<p>Au-delà de l’urgence imposée par le calendrier vaccinal, il est évident que la recherche publique sur les maladies infectieuses doit aussi être financée sur le long terme. A ce jour, les engagements du gouvernement restent ici aussi très insuffisants. En décembre, seuls 8 millions d’euros avaient été débloqués pour financer des projets de recherche contre Covid-19<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>, alors que Frédérique Vidal annonçait un fond d’urgence de 50 millions d’euros en mars<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. Dans le même temps, outre les 750 millions qu’elle a alloués au secteur pharmaceutique pour la recherche de vaccins, l’Allemagne a mis 150 millions sur la table pour dynamiser la recherche publique et centraliser les initiatives<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. L’effort global du gouvernement français n’arrive même pas à la hauteur de celui consenti par la fondation Volkswagen<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>!</p>
<p>Plutôt que d’injecter de l’argent, l’État a choisi de fusionner deux institutions de référence pour l’étude des maladies infectieuses: depuis le 1er janvier l’agence Reacting et l’ANRS sont regroupées au sein d’une entité unique. Or de nombreuses voix ont exprimé leur vive inquiétude vis-à-vis du financement insuffisant de cette entité. Parmi elles, Aides et Sidaction —rejoints notamment par Françoise Barré Sinoussi, prix Nobel— soulignent que seuls 2 millions d’euros ont été sanctuarisés au budget 2021 pour cette nouvelle agence. Ils craignent que l’État se défausse sur les investisseurs privés ou les financements européens pour les 70 millions supplémentaires nécessaire à son bon fonctionnement<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Un collectif de chercheurs signataires d’une tribune dans le Monde dénonce ces mêmes insécurités budgétaires<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
<p><strong>Conclusion</strong></p>
<p>En ce début d’année 2021, rien n’indique que le gouvernement ait pris la mesure des enjeux sanitaires et politiques liés à l’évaluation indépendante des vaccins anti-Covid. Rien n’indique non plus qu’il reconnaisse la nécessité de soutenir la recherche publique sur les maladies infectieuses en général et sur la Covid-19 en particulier.&nbsp;</p>
<p>Alors que le fossé par rapport à notre voisin allemand se creuse à une vitesse phénoménale et que ses finances sont dans le rouge depuis plusieurs années, la recherche publique française doit une nouvelle fois se contenter de miettes. Alors que les autres grandes puissances ont compris l’importance d’un investissement massif dans la recherche et les infrastructures publiques pour faire face aux conséquences de la pandémie, à court et à long terme, le gouvernement français continue à minimiser ses investissements et aggrave ainsi notre dépendance vis-à-vis des acteurs privés. Il est donc urgent de renverser la situation et d’obtenir de sa part:</p>
<ul>
<li><p>Un engagement à financer de façon pérenne et significative les agences Covireivac et Reacting-ANRS.&nbsp;</p></li>
<li><p>L’évaluation indépendante des différentes options vaccinales, sans exclure a priori les vaccins russes ou chinois, sur des cohortes de taille suffisante.</p></li>
<li><p>L’augmentation des crédits alloués à la recherche de traitements contre la maladie car la vaccination ne résoudra pas tous les problèmes.</p></li>
<li><p>Une augmentation des crédits alloués à la recherche en général.</p></li>
</ul>
<p>Sous réserve de financements, seule la recherche publique nationale est en effet en mesure d’assumer pleinement les responsabilités suivantes:</p>
<ul>
<li><p>Compléter et valider le travail des compagnies pharmaceutiques de façon indépendante en contrôlant et en contribuant à la phase 3 des essais cliniques.&nbsp;</p></li>
<li><p>Analyser les données de veille épidémiologique au long-cours qui accompagnent nécessairement les campagnes de vaccination.</p></li>
<li><p>Le cas échéant, réaliser rapidement les études in vitro et in vivo visant à évaluer l’efficacité des tests de dépistages, des vaccins ou des traitements contre les variants qui pourraient apparaitre ou circuler sur notre sol.</p></li>
<li><p>Le cas échéant, réaliser rapidement les études permettant d’évaluer l’efficacité et la sécurité de protocoles autres que ceux définis par les essais cliniques ayant amené à la mise sur le marché des vaccins ou des traitements (par exemple: combinaison de 2 vaccins, report des secondes doses, etc).</p></li>
</ul>
<p><a href="https://lafranceinsoumise.fr/2021/01/28/covid-19-et-recherche-publique-le-fosse-selargit-entre-les-besoins-et-les-moyens/"><strong>Article original</strong></a></p>
<script src="https://giscus.app/client.js" data-repo="romainligneul/giscus-comments" data-repo-id="R_kgDOMSMTIw" data-category="CommentsBlogFR" data-category-id="DIC_kwDOMSMTI84CglZk" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async="">
</script>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Voir l’analyse de <a href="https://www.politico.com/news/2020/07/17/drug-agencies-talk-while-their-governments-fight-366920">Politico, 17/07/20</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Article du <a href="https://www.lemonde.fr/planete/article/2021/01/16/vaccins-ce-que-disent-les-documents-voles-a-l-agence-europeenne-des-medicaments_6066502_3244.html">Monde, 16/01/21</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Voir l’analyse de l’influence de l’EPFIA par <a href="https://www.bastamag.net/Lobbying-comment-l-industrie-pharmaceutique-prend-d-assaut-les-institutions">Bastamag, 24/05/19</a></p>
<p>Voir aussi le travail de l’association <a href="https://corporateeurope.org/en/topics/health">Corporate Europe Laboratory</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Étude <a href="https://www.ifop.com/wp-content/uploads/2021/01/117_591_CP_Ifop_Lemon_2021.01.13.pdf">IFOP du 15/01/21</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Article de <a href="https://www.francetvinfo.fr/sante/maladie/coronavirus/vaccin/vaccins-contre-le-covid-19-huit-questions-sur-covireivac-la-plateforme-pour-les-francais-qui-souhaitent-participer-a-un-essai-clinique_4203971.html">France Info du 3/12/20</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Voir la <a href="https://www.enseignementsup-recherche.gouv.fr/cid155663/www.enseignementsup-recherche.gouv.fr/cid155663/l-effort-global-de-recherche-sur-le-covid-19-porte-a-8-millions-d-euros-afin-de-soutenir-et-coordonner-la-reponse-scientifique-a-la-propagation-du-virus-sur-le-territoire-national.html">publication de l’ESRI</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Article des <a href="https://www.lesechos.fr/politique-societe/societe/un-fonds-durgence-de-50-millions-pour-la-recherche-sur-le-covid-19-1187024">Échos du 19/03/2020</a>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Voir la <a href="https://www.bmbf.de/en/coronavirus-what-the-bmbf-is-doing-11194.html">publication du ministère de l’enseignement supérieur et de la recherche allemand</a>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Voir la <a href="https://www.demogr.mpg.de/en/news_events_6123/news_press_releases_4630/news/covid_19_database_receives_funding_from_volkswagen_foundation_8745">publication de l’institut Max Planck du 11/01/21</a>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Voir le <a href="https://www.aides.org/publication/fusion-anrsreacting-la-lutte-contre-le-vih-et-les-maladies-emergentes-meritent-mieux">communiqué de AIDES du 7/01/21</a>, l’article de <a href="https://vih.org/20201217/recherche-en-maladies-infectieuses-lanrs-et-de-reacting-fusionnent/">VIH.org du 17/12/21</a> et l’article du <a href="https://www.lemonde.fr/planete/article/2021/01/01/une-nouvelle-agence-consacree-aux-maladies-infectieuses-emergentes-en-manque-de-moyens-propres_6064964_3244.html">Monde du 1/01/21</a>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Article du <a href="https://www.lemonde.fr/idees/article/2021/01/14/l-insecurite-budgetaire-dont-souffrira-la-nouvelle-agence-sur-les-maladies-infectieuses-emergentes-ne-peut-qu-etre-nefaste_6066277_3232.html">Monde du 14/01/21</a><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>