---
title: "Admin panel"
---




```{=html}
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, sendEmailVerification } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCH3avPPXfXI49GTopvaFbeKrPtu8ufa2c",
    authDomain: "sbdm2025.firebaseapp.com",
    projectId: "sbdm2025",
    storageBucket: "sbdm2025.firebasestorage.app",
    messagingSenderId: "846447691095",
    appId: "1:846447691095:web:e41322d89f69949469ea12",
    measurementId: "G-G79REFBJ4H"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  document.getElementById("login-btn").addEventListener("click", async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      if (!userCredential.user.emailVerified) {
        alert("Please verify your email address before logging in.");
        await signOut(auth);
        return;
      }
    } catch (error) {
      alert(error.message);
    }
  });

  document.getElementById("signup-btn").addEventListener("click", async () => {
    const email = document.getElementById("signup-email").value;
    const password = document.getElementById("signup-password").value;
    try {
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      await sendEmailVerification(userCredential.user);
      alert("Verification email sent. Please check your inbox.");
    } catch (error) {
      alert(error.message);
    }
  });

  document.getElementById("logout-btn").addEventListener("click", async () => {
    await signOut(auth);
  });

  async function fetchUserData(email) {
    try {
      const response = await fetch(`https://misc.robustcircuit.eu/user/${email}`);
      const result = await response.json();
      console.log(result.data)
      if (result.success) {
        document.getElementById("formName").value = result.data.name;
        document.getElementById("formEmail").value = email;
        document.getElementById("formAffiliation").value = result.data.affiliation;
        document.getElementById("formAbstract").value = result.data.abstract;
        // Prepopulate the radio button based on formSession
        const sessionValue = result.data.session; // Assuming this matches the radio values
        const radioButton = document.querySelector(`input[name="formSession"][value="${sessionValue}"]`);
        if (radioButton) {
            radioButton.checked = true;
        }
      }
    } catch (error) {
      console.error("Error fetching user data:", error);
    }

  }

  onAuthStateChanged(auth, (user) => {
    if (user && user.emailVerified) {
      document.getElementById("auth-container").style.display = "none";
      document.getElementById("user-container").style.display = "block";
      document.getElementById("registrationForm").style.display = "block";
      document.getElementById("user-email").innerText = `Logged in as: ${user.email}`;
      fetchUserData(user.email);
    } else {
      document.getElementById("auth-container").style.display = "block";
      document.getElementById("user-container").style.display = "none";
      document.getElementById("registrationForm").style.display = "none";
    }
  });

    $(document).ready(function () {
    // Fetch data from backend API
    async function fetchUserData(email) {
            let tableBody = "";
            data.forEach(entry => {
                tableBody += `
                    <tr>
                        <td>${entry.name}</td>
                        <td>${entry.email}</td>
                        <td>${entry.title}</td>
                        <td>${entry.affiliation}</td>
                        <td>${entry.session}</td>
                        <td>${entry.foodrestriction}</td>
                        <td>${entry.paid ? 'Yes' : 'No'}</td>
                        <td><button class="btn btn-primary btn-sm" onclick="showAbstract('${entry.abstract.replace(/'/g, "&apos;")}')">View</button></td>
                    </tr>`;
            });
            $("#tableBody").html(tableBody);
        };
    });

    function showAbstract(abstract) {
        $("#modalBody").text(abstract);
        $("#abstractModal").modal("show");
    }

    // Search functionality
    $("#search").on("keyup", function () {
        let value = $(this).val().toLowerCase();
        $("#tableBody tr").filter(function () {
            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
    });


  document.getElementById("registrationForm").addEventListener("submit", async function(event) {
    event.preventDefault();
    const user = auth.currentUser;
    if (!user || !user.emailVerified) return;
    const formData = {
      name: document.getElementById("name").value,
      email: user.email,
      message: document.getElementById("message").value
    };
    try {
      const response = await fetch("https://misc.robustcircuit.eu/submit-form", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
      });
      const result = await response.json();
      document.getElementById("responseMessage").innerText = result.message;
    } catch (error) {
      document.getElementById("responseMessage").innerText = "Error submitting the form.";
    }
  });
  
</script>

```

:::
```{=html}
    <div class="container mt-4">
        <h2 class="mb-3">Form Data Entries</h2>
        <input type="text" id="search" class="form-control mb-3" placeholder="Search...">
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Title</th>
                    <th>Affiliation</th>
                    <th>Session</th>
                    <th>Food Restriction</th>
                    <th>Paid</th>
                    <th>Abstract</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data will be inserted here dynamically -->
            </tbody>
        </table>
    </div>

    <!-- Abstract Modal -->
    <div class="modal fade" id="abstractModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalLabel">Abstract</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Abstract content will be injected here -->
                </div>
            </div>
        </div>
    </div>
```
:::